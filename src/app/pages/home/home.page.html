<ht-header></ht-header>

<ion-content class="home-main-container">
    <ht-header-desktop></ht-header-desktop>

    <div class="hidden-lg crowd-container" *ngIf="isFirstPageThisSession">
        <div class="peoplesvgs">
            <div class="ani1"></div>
            <div class="ani2"></div>
            <div class="ani3"></div>
        </div>
        <div class="intro-story">
            <p class="text-1">In 2003 The Corporation film revealed societyâ€™s dominant institution as a psychopath.</p>
            <p class="text-2">Millions were inspired<br>to get up off their couch<br>and do something!</p>
            <h1 class="text-3">WATCH STORIES.<br>BE INSPIRED</h1>
        </div>
    </div>

    <div class="hidden-sm desktop-crowd-container">
        <img src="../../../assets/images/crowd-of-people.svg">
    </div>

    <div class="home-splash" [class.logged-in]="user" [class.logged-out]="!user">
        <div class="user-avatars-wrapper" *ngIf="user">
            <div class="main-user-avatar">
                <a [routerLink]="['/profile', user.uid]">
                    <img [src]="user.photoURL" [alt]="user.displayName" />
                </a>
            </div>
        </div>

        <ion-card>
            <ion-card-header class="hidden-lg mobile-join-us-card">
                <ion-card-title>
                    {{"SEQUEL COMING SOON"}}
                </ion-card-title>
            </ion-card-header>

            <ion-card-content class="hidden-lg">
                <ng-container *ngIf="user; then contentLoggedIn; else contentLoggedOut"></ng-container>
                <ng-template #contentLoggedIn>
                    <div class="user-action-summary">
                        <h4>{{ user.displayName }}</h4>
                        <div class="action-wrapper">
                            <ion-item>
                                <ion-icon slot="start" name="quote"></ion-icon>
                                <ion-label>
                                    <ng-container *ngIf="user.testimonial != ''; then yesTestimonials; else noTestimonial"></ng-container>
                                    <ng-template #yesTestimonials>
                                        <a [routerLink]="['/profile', user.uid]">
                      Testimonial
                      <br />
                      given
                    </a>
                                    </ng-template>
                                    <ng-template #noTestimonial>
                                        <a href="/user/profile">
                      Add
                      <br />
                      testimonial
                    </a>
                                    </ng-template>
                                </ion-label>
                            </ion-item>
                            <ion-item>
                                <ion-icon slot="start" name="trophy"></ion-icon>
                                <ion-label>
                                    {{ pledgesCount }} Action
                                    <br /> pledges
                                </ion-label>
                            </ion-item>
                            <ion-item>
                                <ion-icon slot="start" name="videocam"></ion-icon>
                                <ion-label>
                                    <ng-container *ngIf="storiesCount > 0; then yesStories; else noStories"></ng-container>
                                    <ng-template #yesStories>{{ storiesCount }} Stories</ng-template>
                                    <ng-template #noStories>
                                        <a href="">
                      Add
                      <br />
                      story
                    </a>
                                    </ng-template>
                                </ion-label>
                            </ion-item>
                        </div>
                    </div>
                </ng-template>
                <ng-template #contentLoggedOut>
                    <ion-button (click)="register()" expand="block" class="content-btn hidden-lg">
                        Join us
                    </ion-button>
                </ng-template>
            </ion-card-content>
        </ion-card>
    </div>

    <div class="mobile-stories-section-intro hidden-lg">
        <h2>PEOPLE ARE HITTING <br> THE STREETS AGAIN!</h2>
        <p>Speaking up like never before about climate change and economic injustice </p>
    </div>


    <ion-grid fixed no-padding class="intro-grid hidden-sm">
        <div class="stories-section-intro-wrapper">
            <ion-row>
                <ion-col>
                    <h2 class="stories-section-intro">Watch Stories.</h2>
                </ion-col>
            </ion-row>
            <ion-row>
                <ion-col>
                    <h2 class="stories-section-intro">Get Inspired.</h2>
                </ion-col>
            </ion-row>
            <ion-row>
                <ion-col>
                    <p>Take action by people who were<br /> transformed by the film.<br /> Add your own story!</p>
                </ion-col>
            </ion-row>
        </div>
    </ion-grid>

    <div class="story-wrapper" *ngFor="let story of stories">
        <a href="story/{{ story.slug }}">
            <div class="story-header">
                <ion-img [src]="story.image"></ion-img>
                <h3 class="story-title">{{ story.title }}{{ story.slug }}</h3>
            </div>
        </a>
        <div class="story-action-summary">
            <div class="pledges summary-box">
                <div class="summary-icon">
                    <img src="../../../assets/images/action-pledges.svg">
                </div>

                <div class="header">
                    <ion-label>{{ story.pledgeCount }}</ion-label>
                    <a (click)="showHelpActionPledgeModal()">
                        Action Pledges
                        </a>
                </div>
            </div>

            <div class="avocadometer summary-box">
                <div class="summary-icon">
                    <img src="../../../assets/images/avocado-meter.svg">
                </div>

                <div class="header">
                    <ion-label>{{ story.avocados }}</ion-label>
                    <a (click)="showHelpAvocadometerModal()">
                        Avocadometer
                        </a>
                </div>
            </div>
        </div>

        <ion-item class="summary" lines="none">
            <ion-label text-wrap>{{ story.summary }}</ion-label>
        </ion-item>

        <ion-item class="story-meta" lines="none">
            <ion-avatar slot="start">
                <img [src]="story.authorImg" />
            </ion-avatar>
            <ion-label>
                <div class="authoring-info">{{ story.authorName }} &bull; {{ story.updatedAt }}</div>
            </ion-label>
        </ion-item>
    </div>

    <ht-footer-ad *ngIf="isFirstPageThisSession"></ht-footer-ad>

</ion-content>